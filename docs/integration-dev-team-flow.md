# Integration Development Team Flow

## Autonomous Agent Flow

Azure Integration Services development workflow using specialized agents to create comprehensive integration patterns, specifications, and implementations.

```mermaid
 flowchart TD
    A[üïµÔ∏è Discovery Analyst<br/>Generates IDD] --> B[üìã Solution Architect<br >Creates IRD]
    B --> C[üîß Agent<br/>Creates dev-plan, creating and assigning issues to GitHub Coding Agent]
    C --> D[üîç Test Engineer<br/>Creates tests, executes & reports the results]
    D --> E[üìö Documentation Specialist<br/>Generates Final Docs]
```

### Discovery Analyst Agent

**Role:** Performs automated discovery of Azure Integration Landing Zones and generates the Integration Discovery Document (IDD).

**Responsibilities:**
- Connect to Azure MCP Server using provided subscription and tag filters.
- Discover deployed Azure Integration Services, AppGW, Frontdoor, App Insights, Log Analytics, Azure Monitor, Key Vault, ASEv3, and App Service Plans.
- Included detailed information about the Network Topology, including VNETs, subnets, and private endpoints.
- Generate architecture diagrams using Mermaid and embed that into the IDD.
- Produce a static document summarizing the findings.

**Output:**
- `/specs/docs/IDD.md`: Integration Discovery Document in Markdown format including architecture diagrams and discovered resources.
- `/specs/diagrams/IDD.mmd`: Mermaid diagram of the IDD.

**Example Prompt:**
```
Please scan my Azure subscription and discover all deployed integration services. Focus on resources tagged with "azd-env-name:azd-ais-lza-prd". Generate the IDD for the discovered architecture. Use any available tools as needed to complete the task.
```

### Solution Architect Agent

**Role:** Crafts and maintains the Integration Requirement Document (IRD), translating business needs into technical requirements, including data mapping and transformation rules

**Responsibilities:**
- Translate business needs into functional and non-functional requirements.
- Identify systems, data formats, and integration objectives.
- Ensure the IRD remains a living document throughout the project.
- Analyze IDD to define integration architecture.
- Select appropriate design patterns and protocols.
- Include security architecture and compliance considerations.
- Include field mappings between source and target systems.
- Generate Mermaid diagrams to explain the integration flows in the IRD.
- Describe in detail in the IRD the integration patterns used, supported by diagrams.
- Ensure alignment with the existing landing zone and best practices.

**Output:**
- `/specs/docs/IRD.md`: Integration Requirement Document in Markdown format.
- `/specs/diagrams/IRD.mmd`: Mermaid diagram of the IRD.

**Example Prompt:**
```
Please analyze the #file:/specs/docs/IDD.md generated by the Discovery Analyst agent and check if there are any raw files added in the /specs/raw/ directory. Include functional and non-functional requirements, data mappings, security considerations, and architecture diagrams. Use any available tools as needed to complete the task. Create an #file:/specs/docs/IRD.md for: <your integration pattern explained in Natural Language, and be as specific as possible>.
```

### Agent

**Role**
Implements integration code using code and Bicep, following the IRD and IDD requirements.

**Inputs**
- `/specs/docs/IRD.md`: Integration Requirements Document
- `/specs/docs/IDD.md`: Integration Discovery Document
- `/specs/diagrams/*.mmd`: Mermaid diagrams of the IRD and IDD

**Instructions**
1. Analyze
   - Analyse the Integration Development Document (IDD) and Integration Requirements Document (IRD).
   - Create a detailed development plan based on the IRD and IDD.
2. Subtask Breakdown  
   - For each step in the development plan, create a subtask that aligns with the requirements in the IRD and IDD.  
   - Ensure each subtask is small enough to be completed within a single commit.  
   - Reference related IRD requirements and IDD discovery context.
   - Implement integration pattern with code and Bicep if needed.
   - Add GitHub Action Pipeline for deploying the integration code.
   - Integration specific services are deployed in a separate resource group or are integrated into existing services, like API Management identified in the IDD.
   - Ensure code aligns with IRD and builds successfully.
   - Create a summary of what has been implemented, including any deviations from the plan. Include a list of test scenarios that can be used to verify the implementation.
4. GitHub Issue Creation
   For each subtask, create a GitHub Issue with:
   - **Title**: Short, descriptive
   - **Description**: What needs to be done, where it fits in the scaffolded structure
   - **Dependencies**: Reference predecessor and successor tasks
   - **Labels**: Use labels like `integration`, `test`, `infra`, `mapping`, `retry`, etc.
   - **Assignee**: GitHub Copilot Coding Agent
4. Review & Commit Strategy  
   - Automatically assign each code review to be executed by GitHub Copilot in GitHub.com, when the PR is created based on the related GitHub Issues.
   - Automatically resolve merge conflicts using GitHub Copilot and commit to `main`.
   - Try to completely automate the commit process for all generated code changes.

**Output**
- `/specs/plans/dev-plan.md`: Markdown file listing all subtasks with dependencies
- `/specs/plans/dev-summary.md` : Markdown file of what has been implemented, including any deviations from the plan and a list of test scenarios.

**Guardrails**
- Do not skip any execution plan steps.
- Avoid creating overlapping or duplicate issues.
- Ensure traceability to IRD and test scenarios.

**Success Criteria**
- All subtasks are clearly defined, testable, and traceable.
- GitHub issues are consistent, actionable, and dependency-aware.
- The development plan aligns with the architecture and requirements.

**Example Prompt:**
```
Based on the specifications in #file:/specs/docs/IDD.md and #file:/specs/docs/IRD.md, generate a detailed development plan in #file:/specs/plans/dev-plan.md that outlines all tasks required to implement the integration pattern. Include in the dev-plan local testing steps, so successful deployment can be ensured and a GitHub Actions CI/CD pipelines for deploying the complete solution. Last task in the dev-plan is to write a summary in #file:/specs/plans/dev-summary.md describing what was implemented, any deviations from the plan, and a list of test scenarios. Then, create GitHub Issues for each task in the dev plan, link them to a single Epic Issue, and assign the GitHub Copilot Coding Agent to the Epic. Do not write documentation or test cases. Use any available tools as needed to complete the task.
```

## Controlled Agent Flow

Instead of using the GitHub Copilot Coding Agent, you can use the following agents to implement the integration code. These agents are designed to work in a controlled environment, where each agent has a specific role and set of responsibilities.

```mermaid
 flowchart TD
    A[üïµÔ∏è Discovery Analyst<br/>Generates IDD] --> B[üìã Solution Architect<br >Creates IRD]
    B --> C[üîß Integration Developer<br/>Creates dev-plan, implementing features according to the plan]
    C --> D[üîç Test Engineer<br/>Creates tests, executes & reports the results]
    D --> E[üìö Documentation Specialist<br/>Generates Final Docs]
```

### Integration Developer Agent

**Role:** Implement a production-ready integration solution for customer onboarding by analyzing the IRD and IDD, creating a detailed development plan, including tests and CI/CD deployment task in GitHub Actions, and summarizing the implementation with traceability and compliance to Azure standards.

**Inputs**
- `/specs/docs/IRD.md`: Integration Requirements Document
- `/specs/docs/IDD.md`: Integration Discovery Document
- `/specs/diagrams/*.mmd`: Mermaid diagrams of the IRD and IDD

**Responsibilities:**
- First analyze the Integration Development Document (IDD) and Integration Requirements Document (IRD).
- Create a detailed development plan based on the IRD and IDD.
- Implement integration pattern using code and Bicep.
 - Develop based on the detailed development plan and keep track of your progress in this plan.
- Integration specific services are deployed in a separate resource group or are integrated into existing services, like API Management identified in the IDD.
- Add GitHub Action Pipeline for deploying the integration code.
- Ensure code aligns with IRD and builds successfully.
- Create a summary of what has been implemented, including any deviations from the plan. Include a list of test scenarios that can be used to verify the implementation.
- Writes clean, maintainable implementation code following team conventions and modular design.

**Output:**
- `/specs/plans/dev-plan.md`: Markdown file listing all subtasks with dependencies
- `/specs/plans/dev-summary.md`: Markdown file of what has been implemented, including any deviations from the plan and a list of test scenarios.

**Example Prompt:**
```
Please implement the integration solution using the provided architecture and requirements documents.
Start by analyzing /specs/docs/IDD.md and /specs/docs/IRD.md to extract all integration-related requirements.
Create a detailed development plan in /specs/plans/dev-plan.md listing all subtasks and their dependencies. Include steps for testing locally and for creating a CI/CD pipeline in GitHub Actions. 
Implement the integration code in /src/* and infrastructure code in /infra/*. Write a summary in /specs/plans/dev-summary.md describing what was implemented, any deviations from the plan, and a list of test scenarios. Do not write documentation or test cases.
Follow all steps in the development plan without skipping any. Ensure the output is production-ready, compliant with Azure deployment standards, and traceable to the IRD. Use any available tools as needed to complete the task.
```

### Test Engineer Agent

**Role:** Converts test cases from the dev-summary into executable test code using standardized frameworks based on integration type and executes them.

**Responsibilities:**
- Select appropriate test framework (e.g., xUnit, MSTest, Postman) based on integration type. And .http file for API testing should always be included.
- Generate test code for each test scenario.
- Ensure tests are maintainable, environment-aware, and aligned with IRD requirements and dev-summary test scenarios.
- Organize tests by feature and scenario.
- Execute the tests one by one using the selected framework, and report the results in test-results.md.
- If the test fails, provide a detailed report of the failure, including the error message and stack trace in `test-results.md`.

**Output:**
- `/tests/code/*.test.js|.cs|.http`: Executable test code files
- `/tests/config/test-config.json`: Environment-aware test configuration
- `/tests/reports/test-results.md`: Test execution results

**Example Prompt:**
```
Generate test code for the integration based on the provided dev-summary and IRD. After generated, execute the tests and report the results.
```

### Documentation Specialist Agent

**Role:** Generates final documentation from code, tests, and features in standardized formats for developers and stakeholders.

**Responsibilities:**
- Extract relevant information from code, tests, and Gherkin features
- Generate documentation in Markdown
- Add instructions on how to run the integration patterns locally and how to deploy them via GitHub Actions
- Include sections such as Overview, Setup, Usage, Troubleshooting, and Architecture Diagrams
- Ensure documentation is accessible to both technical and non-technical audiences

**Output:**
- `./README.md`: Main documentation file
- `./CHANGELOG.md`: Optional changelog for version tracking

**Example Prompt:**
```
Generate comprehensive documentation in #file:../../README.md for this integration project. Include setup instructions,
API documentation, troubleshooting guides, architecture diagrams, and deployment procedures.
Make it accessible to both developers and business stakeholders. Ensure clarity, conciseness, and accuracy. Use any available tools as needed to complete the task.
```
